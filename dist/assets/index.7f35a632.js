import{d as I,r as h,o as y,a as z,c as B,b as g,p as A,e as U,f as C,E as K,g as M,h as R,w as N,v as x,t as V,F as T,i as X}from"./vendor.7defbfcf.js";const q=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function i(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(t){if(t.ep)return;t.ep=!0;const r=i(t);fetch(t.href,r)}};q();var O={name:"drag",mounted(e,o){e.setAttribute("draggable","true")}},w=I({emits:["addFile"],setup(e,o){const i=h(null),l=()=>{if(i){const n=i.value;if(n){const a=n.files;if(a==null?void 0:a.length){const c=a[0];o.emit("addFile",c)}}}},t=["drop","drgaleave","dragenter","dragover"],r=n=>{n.preventDefault()};y(()=>{const n=i.value;n&&n.addEventListener("change",l),t.forEach(s=>{const a=s,c=r;document.addEventListener(a,c)})}),z(()=>{const n=i.value;n&&n.removeEventListener("change",l),t.forEach(s=>{const a=s,c=r;document.removeEventListener(a,c)})});const d=n=>{var a;const s=(a=n.dataTransfer)==null?void 0:a.files;if(s==null?void 0:s.length){const c=s[0];o.emit("addFile",c)}else console.log("\u83B7\u53D6\u6587\u4EF6\u5931\u8D25");v(n)},u=n=>{n.target.classList.add("drag")},v=n=>{n.target.classList.remove("drag")};return{file:i,dropFile:d,dragEnter:u,dragLeave:v}}});const G=e=>(A("data-v-8bf77912"),e=e(),U(),e),J={for:"image-load",class:"label"},Q=G(()=>g("div",{class:"tx"},"\u4E0A\u4F20\u6587\u4EF6",-1)),W={type:"file",accept:"image/*",id:"image-load",ref:"file"};function Y(e,o,i,l,t,r){return C(),B("div",{class:"upload-con",draggable:"true",onDrop:o[0]||(o[0]=(...d)=>e.dropFile&&e.dropFile(...d)),onDragenter:o[1]||(o[1]=(...d)=>e.dragEnter&&e.dragEnter(...d)),onDragleave:o[2]||(o[2]=(...d)=>e.dragLeave&&e.dragLeave(...d))},[g("label",J,[Q,g("input",W,null,512)])],32)}w.render=Y;w.__scopeId="data-v-8bf77912";function k(e,o,i){o=o||.3;var l=document.createElement("canvas"),t=l.getContext("2d"),r=document.createElement("canvas"),d=r.getContext("2d"),u=e.src.length,v=e.width,n=e.height,s;(s=v*n/4e6)>1?(s=Math.sqrt(s),v/=s,n/=s):s=1,l.width=v,l.height=n,t.fillStyle="#fff",t.fillRect(0,0,l.width,l.height);var a;if((a=v*n/1e6)>1){a=~~(Math.sqrt(a)+1);var c=~~(v/a),m=~~(n/a);r.width=c,r.height=m;for(var E=0;E<a;E++)for(var F=0;F<a;F++)d.drawImage(e,E*c*s,F*m*s,c*s,m*s,0,0,c,m),t.drawImage(r,E*c,F*m,c,m)}else t.drawImage(e,0,0,v,n);i?i=`image/${i}`:i="image/webp";var _=l.toDataURL(i,o),f=~~(100*(u-_.length)/u);return f<=0&&(i="image/jpeg",_=l.toDataURL(i,o),f=~~(100*(u-_.length)/u)),console.log("\u538B\u7F29\u524D\uFF1A"+u),console.log("\u538B\u7F29\u540E\uFF1A"+_.length),console.log("\u538B\u7F29\u7387\uFF1A"+f+"%"),r.width=r.height=l.width=l.height=0,{before:{size:u},after:{size:_.length,str:_}}}function S(e){return e<1024*1024?(e/1024).toFixed(1)+"kb":(e/1024/1024).toFixed(1)+"mb"}var $=I({components:{Upload:w,ElInputNumber:K},setup(){const e=h(""),o=h(null),i=h(""),l=h(""),t=h(""),r=f=>{const p=new FileReader;p.onload=function(){if(o&&o.value){const b=o.value;e.value=p.result,b.onload=function(){const D=u.value.getBoundingClientRect();s=D.width,n=D.left;const L=k(b);i.value=S(L.before.size),l.value=L.after.str,t.value=S(L.after.size)}}},p.readAsDataURL(f)},d=h(null),u=h(null);let v=!1,n,s;const a=()=>{v=!0},c=()=>{v=!1},m=f=>{if(v){const b=(f.clientX-n)/s*100+"%";u.value.style.setProperty("--left",b)}},E=f=>{};y(()=>{const f=d.value,p=u.value;f&&(f.addEventListener("mousedown",a),p.addEventListener("mousemove",m),document.addEventListener("mouseup",c))}),z(()=>{const f=d.value,p=u.value;f&&(f.removeEventListener("mousedown",a),p.removeEventListener("mousemove",m),document.removeEventListener("mouseup",c))});const F=h(.92);return{getFile:r,beforeImg:o,beforeSrc:e,beforeSize:i,afterSrc:l,afterSize:t,moveLine:d,handleLine:E,showBox:u,encoder:F,changeEncoder:f=>{const p=o.value;if(!p)return;const b=k(p,f);l.value=b.after.str,t.value=S(b.after.size)}}}});const Z=e=>(A("data-v-f7137562"),e=e(),U(),e),j={class:"con"},ee={class:"img-show",style:{"--left":"50%"},ref:"showBox"},te={class:"before"},oe=["src"],ne={class:"line",ref:"moveLine"},se={class:"after"},re=["src"],ae={class:"params"},le={class:"encoder"},ie=Z(()=>g("span",{class:"des"},"\u56FE\u7247\u538B\u7F29\u8D28\u91CF",-1));function de(e,o,i,l,t,r){const d=M("Upload"),u=M("el-input-number");return C(),B(T,null,[R(d,{onAddFile:e.getFile},null,8,["onAddFile"]),g("div",j,[g("div",ee,[g("div",te,[g("img",{src:e.beforeSrc,alt:"",ref:"beforeImg",draggable:"false"},null,8,oe),N(g("div",{class:"before-text"}," \u538B\u7F29\u524D"+V(e.beforeSize),513),[[x,e.beforeSrc]])]),g("div",ne,null,512),g("div",se,[N(g("div",{class:"after-text"}," \u538B\u7F29\u540E"+V(e.afterSize),513),[[x,e.afterSrc]]),g("img",{src:e.afterSrc,alt:"",draggable:"false"},null,8,re)])],512),g("div",ae,[g("div",le,[ie,R(u,{modelValue:e.encoder,"onUpdate:modelValue":o[0]||(o[0]=v=>e.encoder=v),min:.1,max:1,step:.01,onChange:e.changeEncoder},null,8,["modelValue","min","step","onChange"])])])])],64)}$.render=de;$.__scopeId="data-v-f7137562";const P=X($);P.directive(O.name,O);P.mount("#app");
